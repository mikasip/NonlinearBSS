% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/iVAE_ar1.R
\name{iVAEar1_v2}
\alias{iVAEar1_v2}
\title{Identifiable Variational Autoencoder with AR(1) Latent Structure}
\usage{
iVAEar1_v2(
  data,
  aux_data,
  latent_dim,
  data_prev = NULL,
  test_data = NULL,
  test_data_aux = NULL,
  hidden_units = c(128, 128, 128),
  aux_hidden_units = c(128, 128, 128),
  activation = "leaky_relu",
  source_dist = "gaussian",
  validation_split = 0,
  error_dist = "gaussian",
  error_dist_sigma = 0.01,
  optimizer = NULL,
  lr_start = 0.001,
  lr_end = 1e-04,
  steps = 10000,
  seed = NULL,
  get_prior_means = TRUE,
  true_data = NULL,
  epochs,
  batch_size
)
}
\arguments{
\item{data}{A numeric matrix of observed data (n x p), where n is the number of samples, and p is the number of features.}

\item{aux_data}{A numeric matrix of auxiliary data (n x q), where q is the number of auxiliary variables.}

\item{latent_dim}{An integer specifying the number of latent dimensions.}

\item{data_prev}{Optional. A numeric matrix of previously observed data, used for constructing the AR(1) latent prior. If not provided, the function constructs it automatically.}

\item{test_data}{Optional. A numeric matrix of test data used for validation.}

\item{test_data_aux}{Optional. A numeric matrix of auxiliary data corresponding to the test data.}

\item{hidden_units}{A numeric vector specifying the number of units in each hidden layer for the encoder and decoder.}

\item{aux_hidden_units}{A numeric vector specifying the number of units in each hidden layer for modeling the prior distribution using the auxiliary data.}

\item{activation}{A character string specifying the activation function to be used in hidden layers. Default is `"leaky_relu"`.}

\item{source_dist}{A character string specifying the distribution for the latent variables. Choices are `"gaussian"` (default) or `"laplace"`.}

\item{validation_split}{A numeric value specifying the fraction of training data to use for validation during model fitting. Default is 0.}

\item{error_dist}{A character string specifying the distribution for the reconstruction error. Choices are `"gaussian"` (default) or `"laplace"`.}

\item{error_dist_sigma}{A numeric value specifying the standard deviation for the error distribution. Default is 0.01.}

\item{optimizer}{An optional Keras optimizer object. If NULL (default), an Adam optimizer with polynomial decay is used.}

\item{lr_start}{A numeric value for the initial learning rate. Default is 0.001.}

\item{lr_end}{A numeric value for the final learning rate. Default is 0.0001.}

\item{steps}{An integer specifying the number of optimization steps for learning rate decay. Default is 10,000.}

\item{seed}{An optional integer for setting the random seed to ensure reproducibility. Default is NULL.}

\item{get_prior_means}{Logical. If TRUE, the model returns the prior means and variances. Default is TRUE.}

\item{true_data}{Optional. A numeric matrix of ground truth data for calculating the mean correlation coefficient (MCC) during training.}

\item{epochs}{An integer specifying the number of training epochs.}

\item{batch_size}{An integer specifying the batch size for training.}
}
\value{
A list object of class `"iVAE"` containing:
\item{IC_unscaled}{Unscaled latent variable estimates.}
\item{IC}{Scaled latent variable estimates.}
\item{IC_vars}{Scaled latent variable variances.}
\item{prior_means}{Scaled prior means.}
\item{prior_vars}{Scaled prior variances.}
\item{data_dim}{Dimension of the observed data.}
\item{sample_size}{Sample size of the training data.}
\item{prior_ar1_model}{Trained AR(1) prior model.}
\item{encoder}{Trained encoder model.}
\item{decoder}{Trained decoder model.}
\item{MCCs}{Mean correlation coefficient between the inferred latent variables and true data (if provided).}
\item{call_params}{Parameters used during the function call.}
\item{metrics}{Training metrics such as reconstruction accuracy and KL divergence.}
}
\description{
This function fits an Identifiable Variational Autoencoder (iVAE) model where the latent variables follow an AR(1) process. It also supports handling auxiliary data and accommodates various choices for source and error distributions.
}
\details{
This function implements an Identifiable Variational Autoencoder (iVAE) model with a first-order autoregressive (AR(1)) prior on the latent variables. It allows for flexible configurations of the latent space, auxiliary data, and distributional assumptions for both latent variables and errors. 

The function returns an object of class `"iVAE"`, which includes trained models for the encoder, decoder, and latent AR(1) prior. It also provides the option to return prior means and variances based on the auxiliary data.
}
\examples{
\dontrun{
  # Example usage:
  data <- matrix(rnorm(1000), nrow = 100, ncol = 10)
  aux_data <- matrix(rnorm(200), nrow = 100, ncol = 2)
  model <- iVAEar1(data, aux_data, latent_dim = 3, epochs = 50, batch_size = 32)
  print(model)
}
}
